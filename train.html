<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Military Training Courses</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #1c1c1c; 
            color: #f5f5f5; 
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #2b2b2b; 
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        h1, h2 {
            color: #ffffff; 
            text-align: center;
        }

        .form-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #444;
            border-radius: 5px;
            background-color: #333; 
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 15px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #f5f5f5; 
        }

        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #555; 
            border-radius: 4px;
            background-color: #444; 
            color: #f5f5f5; 
            box-sizing: border-box;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #007bff; 
        }

        button {
            background-color: #007bff; 
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        button:hover {
            background-color: #0056b3; 
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #444; 
            padding: 12px;
            text-align: left;
            color: #f5f5f5; 
        }

        th {
            background-color: #333; 
            color: #ffffff;
        }

        tr:nth-child(even) {
            background-color: #2b2b2b; 
        }

        .actions button {
            margin-right: 5px;
            padding: 5px 10px;
            font-size: 0.9em;
        }

        .delete-btn {
            background-color: #cc0000; 
        }

        .delete-btn:hover {
            background-color: #990000; 
        }

        .nav-bar {
            display: flex;
            justify-content: space-around;
            background-color: #333; 
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .nav-bar button {
            background-color: #444; 
            color: #f5f5f5; 
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        .nav-bar button:hover {
            background-color: #555; 
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Military Training Courses Management</h1>
        
        <!-- Course Form -->
        <div class="form-section">
            <h2>Course Registration</h2>
            <form id="courseForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="course_id">Course ID:</label>
                        <input type="number" id="course_id" readonly>
                    </div>
                    <div class="form-group">
                        <label for="course_name">Course Name:</label>
                        <input type="text" id="course_name" required>
                    </div>
                    <div class="form-group">
                        <label for="duration_days">Duration (Days):</label>
                        <input type="number" id="duration_days" min="1" required>
                    </div>
                    <div class="form-group">
                        <label for="instructor_id">Instructor ID:</label>
                        <select id="instructor_id" required></select>
                    </div>
                    <div class="form-group">
                        <label for="serviceid">Service ID:</label>
                        <select id="serviceid" required></select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="institute">Training Institute:</label>
                    <select id="institute" required>
                        <optgroup label="Army">
                            <option value="National Defence Academy, Khadakvasla, Pune">National Defence Academy, Khadakvasla, Pune</option>
                            <option value="Indian Military Academy, Dehradun">Indian Military Academy, Dehradun</option>
                            <option value="Officer's Training Academy, Chennai">Officer's Training Academy, Chennai</option>
                            <option value="Officer's Training Academy, Gaya">Officer's Training Academy, Gaya</option>
                            <option value="Army War College, Mhow">Army War College, Mhow</option>
                            <option value="Infantry School, Mhow">Infantry School, Mhow</option>
                            <option value="College of Materials Management (CMM), Jabalpur">College of Materials Management (CMM), Jabalpur</option>
                            <option value="AEC Training College and Centre, Pachmarhi">AEC Training College and Centre, Pachmarhi</option>
                            <option value="Military College of Telecommunication (MCTE), Mhow">Military College of Telecommunication (MCTE), Mhow</option>
                            <option value="Rashtriya Indian Military College (RIMC), Dehradun">Rashtriya Indian Military College (RIMC), Dehradun</option>
                            <option value="Remount Training School and Depot, Hempur">Remount Training School and Depot, Hempur</option>
                            <option value="High Altitude Warfare School (HAWS), Gulmarg">High Altitude Warfare School (HAWS), Gulmarg</option>
                            <option value="AC Centre & School (ACCS), Ahmednagar">AC Centre & School (ACCS), Ahmednagar</option>
                            <option value="School of Artillery, Devlali">School of Artillery, Devlali</option>
                            <option value="College of Military Engineering (CME), Pune">College of Military Engineering (CME), Pune</option>
                            <option value="Armed Forces Medical College (AFMC), Pune">Armed Forces Medical College (AFMC), Pune</option>
                            <option value="Military Intelligence Training School and Depot, Pune">Military Intelligence Training School and Depot, Pune</option>
                            <option value="Army School of Physical Training (ASPT), Pune">Army School of Physical Training (ASPT), Pune</option>
                            <option value="Institute of National Integration, Pune">Institute of National Integration, Pune</option>
                            <option value="Institute of Military Law, Kamptee">Institute of Military Law, Kamptee</option>
                            <option value="Army Sports Institute, Pune">Army Sports Institute, Pune</option>
                            <option value="Combat Army Aviation Training School, Nasik Road Camp, Nasik">Combat Army Aviation Training School, Nasik Road Camp, Nasik</option>
                            <option value="Heavy Bridging Training Camp, Marve">Heavy Bridging Training Camp, Marve</option>
                            <option value="Army Air Defence College (AADC), Gopalpur">Army Air Defence College (AADC), Gopalpur</option>
                            <option value="Junior Leaders Wing, Infantry School, Belgaum">Junior Leaders Wing, Infantry School, Belgaum</option>
                            <option value="Army Service Corps (ASC), Bangalore">Army Service Corps (ASC), Bangalore</option>
                            <option value="CMP Centre & School, Bangalore">CMP Centre & School, Bangalore</option>
                            <option value="Rashtriya Military School, Belgaum">Rashtriya Military School, Belgaum</option>
                            <option value="Rashtriya Military School, Bangalore">Rashtriya Military School, Bangalore</option>
                            <option value="Counter Insurgency and Jungle Warfare (CIJW) School, Vairengte">Counter Insurgency and Jungle Warfare (CIJW) School, Vairengte</option>
                            <option value="Junior Leader's Academy, Bareilly">Junior Leader's Academy, Bareilly</option>
                            <option value="Army Medical Corps (AMC) Centre & School, Lucknow">Army Medical Corps (AMC) Centre & School, Lucknow</option>
                            <option value="RVC Centre & School, Meerut Cantt.">RVC Centre & School, Meerut Cantt.</option>
                            <option value="Army Airborne Training School, Agra">Army Airborne Training School, Agra</option>
                            <option value="Remount Training School and Depot, Saharanpur">Remount Training School and Depot, Saharanpur</option>
                            <option value="Electronic and Mechanical Engineering (EME) School, Vadodara">Electronic and Mechanical Engineering (EME) School, Vadodara</option>
                            <option value="Military College of Electronic and Mechanical Engineering (MCEME), Secunderabad">Military College of Electronic and Mechanical Engineering (MCEME), Secunderabad</option>
                            <option value="Simulator Development Division, Trimulgherry, Secunderabad">Simulator Development Division, Trimulgherry, Secunderabad</option>
                            <option value="Rashtriya Military School, Ajmer">Rashtriya Military School, Ajmer</option>
                            <option value="Rashtriya Military School, Dholpur">Rashtriya Military School, Dholpur</option>
                            <option value="Rashtriya Military School, Chail">Rashtriya Military School, Chail</option>
                            <option value="Special Forces Training School, Nahan">Special Forces Training School, Nahan</option>
                            <option value="Mechanised Infantry Regimental Centre, Ahmednagar">Mechanised Infantry Regimental Centre, Ahmednagar</option>
                            <option value="Artillery Training Centre, Nasik">Artillery Training Centre, Nasik</option>
                            <option value="Bombay Engineer Group and Centre, Kirkee">Bombay Engineer Group and Centre, Kirkee</option>
                            <option value="Guards Training Centre, Kamptee">Guards Training Centre, Kamptee</option>
                            <option value="Army Postal Service Centre, Kamptee">Army Postal Service Centre, Kamptee</option>
                            <option value="Punjab Regimental Centre, Ramgarh">Punjab Regimental Centre, Ramgarh</option>
                            <option value="Sikh Regimental Centre, Ramgarh">Sikh Regimental Centre, Ramgarh</option>
                            <option value="Madras Engineer Group & Centre, Bangalore">Madras Engineer Group & Centre, Bangalore</option>
                            <option value="Parachute Regimental Centre, Bangalore">Parachute Regimental Centre, Bangalore</option>
                            <option value="Maratha Light Infantry Regimental Centre, Belgaum">Maratha Light Infantry Regimental Centre, Belgaum</option>
                            <option value="Army Service Corps Centre(South), Bangalore">Army Service Corps Centre(South), Bangalore</option>
                            <option value="Pioneer Corps Centre, Bangalore">Pioneer Corps Centre, Bangalore</option>
                            <option value="Army Service Centre(North), Bangalore">Army Service Centre(North), Bangalore</option>
                        </optgroup>
                        <optgroup label="Navy">
                            <option value="Indian Naval Academy, Ezhimala">Indian Naval Academy, Ezhimala</option>
                            <option value="National Hydrographic School, Goa">National Hydrographic School, Goa</option>
                            <option value="INS Dronacharya, Kochi">INS Dronacharya, Kochi</option>
                            <option value="Anti Submarine Warfare School, INS Venduruthy, Kochi">Anti Submarine Warfare School, INS Venduruthy, Kochi</option>
                            <option value="Navigation and Direction School, INS Venduruthy, Kochi">Navigation and Direction School, INS Venduruthy, Kochi</option>
                            <option value="Signal School, INS Venduruthy, Kochi">Signal School, INS Venduruthy, Kochi</option>
                            <option value="Naval Institute of Education and Training Technology, INS Venduruthy, Kochi">Naval Institute of Education and Training Technology, INS Venduruthy, Kochi</option>
                            <option value="Indian Navy Physical Training School, INS Mandovi, Goa">Indian Navy Physical Training School, INS Mandovi, Goa</option>
                            <option value="Diving School, INS Venduruthy, Kochi">Diving School, INS Venduruthy, Kochi</option>
                            <option value="School for Naval Airmen, Kochi">School for Naval Airmen, Kochi</option>
                            <option value="Naval Institute of Aeronautical Technology, Kochi">Naval Institute of Aeronautical Technology, Kochi</option>
                            <option value="INS Satavahana, Visakhapatnam">INS Satavahana, Visakhapatnam</option>
                            <option value="INS Agrani, Coimbatore">INS Agrani, Coimbatore</option>
                            <option value="INS Chilka, Orissa">INS Chilka, Orissa</option>
                            <option value="INS Shivaji, Lonavala">INS Shivaji, Lonavala</option>
                            <option value="NBCD School, INS Shivaji, Lonavala">NBCD School, INS Shivaji, Lonavala</option>
                            <option value="INS Hamla, Mumbai">INS Hamla, Mumbai</option>
                            <option value="Naval War College, Goa">Naval War College, Goa</option>
                            <option value="INS Valsura, Jamnagar">INS Valsura, Jamnagar</option>
                            <option value="Shipwright School, Visakhapatnam">Shipwright School, Visakhapatnam</option>
                            <option value="Institute of Naval Medicine, Mumbai">Institute of Naval Medicine, Mumbai</option>
                            <option value="Naval Police and Regulating School, INS Mandovi, Goa">Naval Police and Regulating School, INS Mandovi, Goa</option>
                            <option value="Naval School of Music, INS Kunjali, Mumbai">Naval School of Music, INS Kunjali, Mumbai</option>
                            <option value="Naval Special Warfare Training cum Tactical Centre, Goa">Naval Special Warfare Training cum Tactical Centre, Goa</option>
                            <option value="Centre for Leadership and Behavioural Studies, Kochi">Centre for Leadership and Behavioural Studies, Kochi</option>
                            <option value="Seamanship School, INS Venduruthy, Kochi">Seamanship School, INS Venduruthy, Kochi</option>
                            <option value="Observer School, Kochi">Observer School, Kochi</option>
                            <option value="School for Naval Oceanography and Meteorology, Kochi">School for Naval Oceanography and Meteorology, Kochi</option>
                            <option value="Maritime Warfare Centre, Kochi">Maritime Warfare Centre, Kochi</option>
                            <option value="School of Advanced Undersea Warfare, Visakhapatnam">School of Advanced Undersea Warfare, Visakhapatnam</option>
                            <option value="School for Medical Assistants, Mumbai">School for Medical Assistants, Mumbai</option>
                        </optgroup>
                        <optgroup label="Air Force">
                            <option value="Air Force Academy, Dundigal, Hyderabad">Air Force Academy, Dundigal, Hyderabad</option>
                            <option value="Basic Flying Training School, Allahabad">Basic Flying Training School, Allahabad</option>
                            <option value="Navigation Training School, Begumpet">Navigation Training School, Begumpet</option>
                            <option value="Air Force Station, Hakimpet">Air Force Station, Hakimpet</option>
                            <option value="Helicopter Training School, Hakimpet">Helicopter Training School, Hakimpet</option>
                            <option value="Fixed Wing Training Flying Yelahanka, Bengaluru">Fixed Wing Training Flying Yelahanka, Bengaluru</option>
                            <option value="Air Force Station, Bidar">Air Force Station, Bidar</option>
                            <option value="112 Helicopter Unit, Yelahanka, Bengaluru">112 Helicopter Unit, Yelahanka, Bengaluru</option>
                            <option value="Air Force Technical College, Jalahalli, Bengaluru">Air Force Technical College, Jalahalli, Bengaluru</option>
                            <option value="Basic Training Institute (BTI), Belgaum">Basic Training Institute (BTI), Belgaum</option>
                            <option value="Non Technical Training Institute (NTTI), Belgaum">Non Technical Training Institute (NTTI), Belgaum</option>
                            <option value="Air Force School of Physical Fitness (AFSPS), Belgaum">Air Force School of Physical Fitness (AFSPS), Belgaum</option>
                            <option value="Garud Regimental Training Centre (GRTC), Chandinagar">Garud Regimental Training Centre (GRTC), Chandinagar</option>
                            <option value="Air Force Police & Security Training Institute (AFP & STI), Chandinagar">Air Force Police & Security Training Institute (AFP & STI), Chandinagar</option>
                            <option value="Medical Training Centre (MTC), Bengaluru">Medical Training Centre (MTC), Bengaluru</option>
                            <option value="Communication Training Institute (CTI), Jalahalli, Bengaluru">Communication Training Institute (CTI), Jalahalli, Bengaluru</option>
                            <option value="Electronic Training Institute (ETI), Jalahalli, Bengaluru">Electronic Training Institute (ETI), Jalahalli, Bengaluru</option>
                            <option value="Mechanical Training Institute (MTI), Tambaram, Chennai">Mechanical Training Institute (MTI), Tambaram, Chennai</option>
                            <option value="Electrical and Instrument Training Institute (E&ITI), Jalahalli, Bengaluru">Electrical and Instrument Training Institute (E&ITI), Jalahalli, Bengaluru</option>
                            <option value="Workshop Training Institute (WTI), Tambaram, Chennai">Workshop Training Institute (WTI), Tambaram, Chennai</option>
                            <option value="Mechanical Transport Training Institute (MTTI), Avadi, Chennai">Mechanical Transport Training Institute (MTTI), Avadi, Chennai</option>
                        </optgroup>
                        <optgroup label="DRDO">
                            <option value="Institute of Technology Management (ITM), Mussoorie">Institute of Technology Management (ITM), Mussoorie</option>
                            <option value="Defence Institute of Advanced Technology (DIAT), Deemed University, Pune">Defence Institute of Advanced Technology (DIAT), Deemed University, Pune</option>
                            <option value="Military Institute of Training (MILIT), Pune">Military Institute of Training (MILIT), Pune</option>
                            <option value="DRDO Training Institute (DTI) under Defence Laboratory, Jodhpur">DRDO Training Institute (DTI) under Defence Laboratory, Jodhpur</option>
                            <option value="Targeted Training Centre (TTC) under Gas Turbine Research Establishment (GTRE), Bengaluru">Targeted Training Centre (TTC) under Gas Turbine Research Establishment (GTRE), Bengaluru</option>
                        </optgroup>
                    </select>
                </div>
                
                <button type="submit" id="submitBtn">Add Course</button>
            </form>
        </div>

        <!-- Filter Section -->
        <div class="form-section">
            <h2>Filter Courses</h2>
            <div class="filter-section">
                <div class="form-group">
                    <label>Course Name:</label>
                    <input type="text" id="filterCourseName">
                </div>
                <div class="form-group">
                    <label>Institute:</label>
                    <select id="filterInstitute">
                        <option value="">All</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Duration (Days):</label>
                    <input type="number" id="filterDuration" min="1">
                </div>
            </div>
            <button onclick="applyFilters()">Apply Filters</button>
        </div>

        <table id="coursesTable">
            <thead>
                <tr>
                    <th>Course ID</th>
                    <th>Course Name</th>
                    <th>Duration</th>
                    <th>Instructor ID</th>
                    <th>Service ID</th>
                    <th>Institute</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="tableBody">

            </tbody>
        </table>
    </div>

    <script>
        let training_courses = JSON.parse(localStorage.getItem('training_courses')) || [];
        let currentCourseId = training_courses.length > 0 ? Math.max(...training_courses.map(c => c.course_id)) + 1 : 1;
        let editingId = null;

        document.getElementById('courseForm').addEventListener('submit', handleSubmit);
        renderTable();

        
        function handleSubmit(e) {
            e.preventDefault();

            const courseData = {
                course_name: document.getElementById('course_name').value.trim(),
                duration_days: parseInt(document.getElementById('duration_days').value),
                instructor_id: parseInt(document.getElementById('instructor_id').value),
                serviceid: parseInt(document.getElementById('serviceid').value),
                institute: document.getElementById('institute').value
            };

            if (!validateCourse(courseData)) return;

            fetch('http://localhost:3001/api/training_courses', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(courseData)
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to add course');
                    }
                    return response.json(); 
                })
                .then(updatedCourses => {
                    training_courses = updatedCourses;
                    renderTable();
                    clearForm(); 
                    alert('Course added successfully!');
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Failed to add course');
                });
        }

       
        function renderTable(data = training_courses) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = ''; 

            data.forEach(course => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${course.course_id}</td>
                    <td>${course.course_name}</td>
                    <td>${course.duration_days} days</td>
                    <td>${course.instructor_id}</td>
                    <td>${course.serviceid}</td>
                    <td>${course.institute}</td>
                    <td class="actions">
                        <button onclick="editCourse(${course.course_id})">Edit</button>
                        <button class="delete-btn" onclick="deleteCourse(${course.course_id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }


        function editCourse(id) {
            const course = training_courses.find(c => c.course_id === id);
            document.getElementById('course_id').value = course.course_id;
            document.getElementById('course_name').value = course.course_name;
            document.getElementById('duration_days').value = course.duration_days;
            document.getElementById('instructor_id').value = course.instructor_id;
            document.getElementById('serviceid').value = course.serviceid;
            document.getElementById('institute').value = course.institute;
            editingId = id;
            document.getElementById('submitBtn').textContent = 'Update Course';
        }

        
        function deleteCourse(id) {
            if (confirm('Permanently delete this course record?')) {
                training_courses = training_courses.filter(c => c.course_id !== id);
                saveToLocalStorage();
                renderTable();
            }
        }

        
        function applyFilters() {
            const courseName = document.getElementById('filterCourseName').value.toLowerCase();
            const institute = document.getElementById('filterInstitute').value;
            const duration = document.getElementById('filterDuration').value;

            let filtered = training_courses.filter(c => {
                const matchesName = c.course_name.toLowerCase().includes(courseName);
                const matchesInstitute = institute ? c.institute === institute : true;
                const matchesDuration = duration ? c.duration_days == duration : true;
                return matchesName && matchesInstitute && matchesDuration;
            });

            renderTable(filtered);
        }

       
        function validateCourse(data) {
            if (!data.course_name || !data.duration_days || !data.instructor_id || !data.serviceid || !data.institute) {
                alert('Please fill in all required fields');
                return false;
            }
            if (data.duration_days < 1) {
                alert('Duration must be at least 1 day');
                return false;
            }
            return true;
        }

        
        function clearForm() {
            document.getElementById('courseForm').reset();
            document.getElementById('course_id').value = currentCourseId; // Set the next course ID
            editingId = null;
            document.getElementById('submitBtn').textContent = 'Add Course';
        }

        function saveToLocalStorage() {
            localStorage.setItem('training_courses', JSON.stringify(training_courses));
            localStorage.setItem('currentCourseId', currentCourseId);
        }

        
        function populateServiceIdDropdown() {
            fetch('http://localhost:3001/api/soldiers')
                .then(response => response.json())
                .then(data => {
                    const serviceIdDropdown = document.getElementById('serviceid');
                    serviceIdDropdown.innerHTML = data.map(soldier => 
                        `<option value="${soldier.serviceid}">${soldier.serviceid} - ${soldier.first_name} ${soldier.last_name}</option>`
                    ).join('');
                })
                .catch(error => console.error('Error fetching soldiers:', error));
        }

        function populateInstructorDropdown() {                                                                                                                                                                                                             
            fetch('http://localhost:3001/api/soldiers')
                .then(response => response.json())
                .then(data => {
                    const instructorDropdown = document.getElementById('instructor_id');
                    instructorDropdown.innerHTML = data.map(soldier => 
                        `<option value="${soldier.serviceid}">${soldier.serviceid} - ${soldier.first_name} ${soldier.last_name}</option>`
                    ).join('');
                })
                .catch(error => console.error('Error fetching soldiers:', error));
        }

      
        document.addEventListener('DOMContentLoaded', () => {
            fetch('http://localhost:3001/api/training_courses')
                .then(response => response.json())
                .then(data => {
                    training_courses = data; 
                    renderTable(); 
                })
                .catch(error => console.error('Error fetching courses:', error));

            populateServiceIdDropdown();
            populateInstructorDropdown();
            renderTable(); 
            renderTable();
        });
    </script>
</body>
</html>
